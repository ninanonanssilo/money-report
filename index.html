<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>품의 기안 생성기</title>
    <meta name="description" content="견적서(엑셀/PDF)로 품의서를 자동 작성합니다." />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600&family=Spectral:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />
    <script src="main.js" type="module" defer></script>
  </head>
  <body>
    <aside id="sidebar" class="sidebar" aria-label="카테고리">
      <div class="side-head">
        <div class="side-brand" aria-label="서비스">
          <div class="side-mark" aria-hidden="true"></div>
          <div class="side-brand-text">
            <div class="side-app">Edu Tools</div>
            <div class="side-sub">업무 자동화 도우미</div>
          </div>
        </div>
        <button id="navClose" class="icon-btn" type="button" aria-label="닫기">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <nav class="side-nav" aria-label="카테고리 목록">
        <div class="side-section">생성기</div>
        <a class="side-link is-active" href="/" aria-current="page">
          <span class="side-ico" aria-hidden="true">P</span>
          <span class="side-label">품의 기안 생성기</span>
        </a>
        <a class="side-link" href="https://educate1.pages.dev/" target="_blank" rel="noreferrer">
          <span class="side-ico" aria-hidden="true">D</span>
          <span class="side-label">학교 공문 자동 작성</span>
          <span class="side-ext" aria-hidden="true">↗</span>
        </a>
        <div class="side-divider" role="separator" aria-hidden="true"></div>
        <div class="side-section">연동</div>
        <div class="side-note">추후 이 메뉴에서 서비스 간 연동을 추가합니다.</div>
      </nav>
      <div class="side-foot">
        <div class="side-foot-spacer" aria-hidden="true"></div>
      </div>
    </aside>
    <div id="scrim" class="scrim" aria-hidden="true"></div>

    <header class="top">
      <div class="top-inner">
        <button id="navToggle" class="nav-toggle" type="button" aria-label="카테고리 열기" aria-expanded="false">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </button>
        <div>
          <h1 class="title">품의 기안 생성기</h1>
          <div class="subtitle">견적서 첨부로 공문서 품의 문서를 자동으로 작성합니다.</div>
        </div>
      </div>
    </header>

    <main class="page">
      <section class="guide" aria-label="안내">
        <div class="guide-col">
          <div class="guide-h">1. 개요</div>
          <ul class="guide-ul">
            <li>품목 내용을 기반으로 기본적인 개요 내용을 제공합니다.</li>
            <li>필수 항목만 입력해도 문서 생성이 가능합니다.</li>
            <li>각 항목의 ‘내용복사’ 버튼으로 빠르게 복사할 수 있습니다.</li>
          </ul>
        </div>
        <div class="guide-col">
          <div class="guide-h">2. 파일 업로드</div>
          <ul class="guide-ul">
            <li>버튼을 클릭하시면 업로드 가능합니다.</li>
            <li>다운로드 한 엑셀파일을 그대로 업로드하시면 상품이 자동으로 입력됩니다.</li>
            <li class="em">파일 업로드 시 더 쉽고 빠르게 입력이 가능합니다.</li>
          </ul>
        </div>
      </section>

      <section class="section">
        <div class="section-head">
          <h2 class="section-title">에듀파인 업로드 항목 복사 및 양식 다운로드</h2>
          <a class="link" href="/assets/edufine_quote_template_20260214.xlsx" download>업로드 양식 다운로드</a>
        </div>

        <div class="form-wrap">
          <table class="form-table" aria-label="품의 입력">
            <tbody>
              <tr>
                <th scope="row">견적서 파일</th>
                <td>
                  <div class="row">
                    <input
                      id="file"
                      class="file"
                      type="file"
                      accept=".xls,.xlsx,.pdf,application/pdf"
                      aria-label="견적서 파일 선택"
                    />
                    <button id="btn-extract" class="btn" type="button">업로드/추출</button>
                    <div id="file-hint" class="hint">지원: .xls, .xlsx, .pdf</div>
                  </div>
                </td>
              </tr>
              <tr>
                <th scope="row">제목</th>
                <td>
                  <input id="subject" class="input" type="text" placeholder="예: 소프트웨어 구독 결제 품의" />
                </td>
              </tr>
              <tr>
                <th scope="row">회계연도</th>
                <td>
                  <input id="fiscalYear" class="input" type="text" inputmode="numeric" placeholder="예: 2026" />
                </td>
              </tr>
              <tr>
                <th scope="row">품의번호</th>
                <td>
                  <input id="approvalNo" class="input" type="text" placeholder="예: 2022R100006275200375" />
                </td>
              </tr>
              <tr>
                <th scope="row">작성일</th>
                <td>
                  <input id="docDate" class="input" type="date" />
                </td>
              </tr>
              <tr>
                <th scope="row">품의개요</th>
                <td>
                  <div class="textarea-row">
                    <textarea id="purpose" class="textarea" rows="6" placeholder="예: 프로젝트 운영을 위한 필수 라이선스 확보"></textarea>
                    <div class="textarea-actions">
                      <button id="btn-auto-outline" class="pill pill-primary" type="button">개요 자동생성</button>
                      <button id="btn-copy-purpose" class="pill" type="button">내용복사</button>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th scope="row">비고</th>
                <td>
                  <textarea id="notes" class="textarea" rows="3" placeholder="예: 검토 요청 사항, 결재 라인 안내 등"></textarea>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="actions">
            <button id="btn-generate" class="btn btn-primary" type="button">품의서 생성</button>
          </div>

          <div id="status" class="status" role="status" aria-live="polite"></div>
        </div>
      </section>

      <section class="section">
        <div class="section-head">
          <h2 class="section-title">품목내역</h2>
        </div>
        <div id="extractSummary" class="summary"></div>
        <div class="table-wrap">
          <table class="table" aria-label="추출 항목">
            <thead>
              <tr>
                <th class="num w-no">순번</th>
                <th>내용</th>
                <th class="w-spec">규격</th>
                <th class="num w-qty">수량</th>
                <th class="num w-unit">단가</th>
                <th class="num w-amt">금액</th>
              </tr>
            </thead>
            <tbody id="itemsTbody"></tbody>
          </table>
        </div>
      </section>

      <section class="section">
        <div class="section-head">
          <h2 class="section-title">생성 결과</h2>
          <div class="head-actions">
            <button id="btn-copy" class="btn btn-ghost" type="button">복사</button>
            <button id="btn-print" class="btn btn-ghost" type="button">인쇄</button>
          </div>
        </div>
        <article id="doc" class="doc" aria-label="품의서 미리보기">
          <div class="doc-empty">아직 문서가 없습니다. 위에서 추출/생성을 진행하세요.</div>
        </article>
      </section>
    </main>

    <template id="docTemplate">
      <section class="doc-page doc-official">
        <div class="doc-official-title">지출 품의서</div>

        <div class="doc-official-top">
          <div class="left"><span class="k">회계연도 :</span> <span data-bind="fiscalYear"></span>년</div>
          <div class="right"><span class="k">품의번호</span> <span data-bind="approvalNo"></span></div>
        </div>

        <table class="doc-official-table" aria-label="지출 품의서">
          <tbody>
            <tr>
              <th scope="row" class="w-key">제 목</th>
              <td data-bind="subject"></td>
            </tr>
            <tr>
              <th scope="row" class="w-key">품<br />의<br />개<br />요</th>
              <td class="doc-pre" data-bind="purpose"></td>
            </tr>
            <tr>
              <th scope="row" class="w-key"></th>
              <td class="doc-sign">
                <div class="sign-grid">
                  <div class="sign-cell"></div>
                  <div class="sign-cell"></div>
                  <div class="sign-cell"></div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </section>
    </template>
  </body>
</html>
