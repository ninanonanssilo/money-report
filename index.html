<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>품의 기안 생성기</title>
    <meta name="description" content="견적서(엑셀/PDF)로 품의서를 자동 작성합니다." />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />

    <link rel="stylesheet" href="style.css?v=20260215-02" />
    <script src="main.js?v=20260215-02" type="module" defer></script>
  </head>
  <body>
    <aside id="sidebar" class="sidebar" aria-label="카테고리">
      <div class="side-head">
        <div class="side-brand" aria-label="서비스">
          <div class="side-mark" aria-hidden="true"></div>
          <div class="side-brand-text">
            <div class="side-app">Edu Tools</div>
            <div class="side-sub">업무 자동화 도우미</div>
          </div>
        </div>
        <button id="navClose" class="icon-btn" type="button" aria-label="닫기">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <nav class="side-nav" aria-label="카테고리 목록">
        <div class="side-section">생성기</div>
        <a class="side-link is-active" href="/" aria-current="page">
          <span class="side-ico" aria-hidden="true">P</span>
          <span class="side-label">품의 기안 생성기</span>
        </a>
        <a class="side-link" href="https://educate1.pages.dev/" target="_blank" rel="noreferrer">
          <span class="side-ico" aria-hidden="true">D</span>
          <span class="side-label">학교 공문 자동 작성</span>
          <span class="side-ext" aria-hidden="true">↗</span>
        </a>
        <div class="side-divider" role="separator" aria-hidden="true"></div>
        <div class="side-section">연동</div>
        <div class="side-note">추후 이 메뉴에서 서비스 간 연동을 추가합니다.</div>
      </nav>
      <div class="side-foot">
        <div class="side-foot-spacer" aria-hidden="true"></div>
      </div>
    </aside>
    <div id="scrim" class="scrim" aria-hidden="true"></div>

    <header class="top">
      <div class="top-inner">
        <button id="navToggle" class="nav-toggle" type="button" aria-label="카테고리 열기" aria-expanded="false">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </button>
        <div class="hero">
          <div class="hero-top">
            <h1 class="title">품의 기안 생성기</h1>
            <!-- 배지 제거 -->
          </div>
          <div class="subtitle">견적서 첨부로 공문서 품의 문서를 자동으로 작성합니다.</div>
        </div>
      </div>
    </header>

    <main class="page">
      <section class="guide" aria-label="안내">
        <div class="guide-col">
          <div class="guide-h">1. 사용 안내</div>
          <ul class="guide-ul">
            <li>업로드한 견적서에서 품목과 금액 정보를 읽어 품의개요 초안을 만듭니다.</li>
            <li>제목만 먼저 입력해도 개요 자동생성을 실행할 수 있습니다.</li>
            <li>생성된 문장은 필요한 부분만 ‘내용복사’로 바로 가져갈 수 있습니다.</li>
          </ul>
        </div>
        <div class="guide-col">
          <div class="guide-h">2. 견적서 업로드</div>
          <ul class="guide-ul">
            <li>파일을 선택한 뒤 ‘업로드/추출’을 누르면 품목내역이 표에 채워집니다.</li>
            <li>제공된 양식(엑셀)을 그대로 사용하면 인식 정확도가 더 좋아집니다.</li>
            <li class="em">파일로 시작하면 반복 입력 시간을 크게 줄일 수 있습니다.</li>
          </ul>
        </div>
      </section>

      <section class="section">
        <div class="section-head">
          <h2 class="section-title">에듀파인 업로드 항목 복사 및 양식 다운로드</h2>
          <a class="link" href="/assets/edufine_quote_template_20260214.xlsx" download>업로드 양식 다운로드</a>
        </div>

        <div class="form-wrap">
          <table class="form-table" aria-label="품의 입력">
            <tbody>
              <tr>
                <th scope="row">견적서 파일</th>
                <td>
                  <div class="row">
                    <input
                      id="file"
                      class="file"
                      type="file"
                      accept=".xls,.xlsx,.pdf,application/pdf"
                      multiple
                      aria-label="견적서 파일 선택"
                    />
                    <button id="btn-extract" class="btn" type="button">업로드/추출</button>
                    <button id="btn-chatgpt" class="pill" type="button" disabled>ChatGPT 검증</button>
                    <div id="file-hint" class="hint">지원: .xls, .xlsx, .pdf</div>
                  </div>
                </td>
              </tr>
              <tr>
                <th scope="row">제목</th>
                <td>
                  <input id="subject" class="input" type="text" placeholder="예: 소프트웨어 구독 결제 품의" />
                </td>
              </tr>
              <tr>
                <th scope="row">작성일</th>
                <td>
                  <input id="docDate" class="input" type="date" />
                </td>
              </tr>
              <tr>
                <th scope="row">품목내역</th>
                <td>
                  <div id="status" class="status" role="status" aria-live="polite"></div>
                  <div id="extractSummary" class="summary"></div>
                  <div class="table-wrap table-in-form">
                    <table class="table" aria-label="추출 항목">
                      <thead>
                        <tr>
                          <th class="num w-no">순번</th>
                          <th>내용</th>
                          <th class="w-spec">규격</th>
                          <th class="num w-qty">수량</th>
                          <th class="num w-unit">단가</th>
                          <th class="num w-amt">금액</th>
                        </tr>
                      </thead>
                      <tbody id="itemsTbody"></tbody>
                    </table>
                  </div>
                </td>
              </tr>
              <tr>
                <th scope="row">품의개요</th>
                <td>
                  <div class="textarea-row">
                    <textarea id="purpose" class="textarea" rows="6" placeholder="제목만 입력해도 자동 생성됩니다. (원하면 수정/추가 가능)"></textarea>
                    <div class="textarea-actions">
                      <button id="btn-auto-outline" class="pill pill-primary" type="button">개요 자동생성</button>
                      <button id="btn-copy-purpose" class="pill" type="button">내용복사</button>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th scope="row">비고</th>
                <td>
                  <textarea id="notes" class="textarea" rows="3" placeholder="예: 검토 요청 사항, 결재 라인 안내 등"></textarea>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <footer class="footer" aria-label="저작권">
      <div class="footer-inner">
        <div class="footer-title">품의 기안 생성기</div>
        <div class="footer-copy">Copyright © HONGSEOK LEE. All rights reserved.</div>
      </div>
    </footer>

  </body>
</html>
